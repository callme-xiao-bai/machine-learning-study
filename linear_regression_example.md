# 多元线性回归求解示例

## 1. 基本概念
多元线性回归试图找到一个线性函数来预测目标值：
y = w₁x₁ + w₂x₂ + ... + wₙxₙ + b

其中：
- y 是预测值
- x₁, x₂, ..., xₙ 是特征值
- w₁, w₂, ..., wₙ 是权重
- b 是偏置项

## 2. 实际例子：房价预测

### 2.1 问题描述
预测房价，已知：
- x₁: 房屋面积（平方米）
- x₂: 距离地铁站距离（公里）
- y: 房价（万元）

### 2.2 样本数据
| 面积(x₁) | 距离地铁(x₂) | 房价(y) |
|---------|------------|--------|
| 50      | 2.0        | 100    |
| 60      | 1.5        | 150    |
| 80      | 1.0        | 200    |
| 70      | 2.5        | 120    |

### 2.3 求解步骤

1. **构建矩阵形式**
   ```
   X = [x₁₁ x₁₂ 1]   y₁
      [x₂₁ x₂₂ 1]   y₂
      [x₃₁ x₃₂ 1]   y₃
      [x₄₁ x₄₂ 1]   y₄
   ```
   
   具体数值：
   ```
   X = [50 2.0 1]   [100]
      [60 1.5 1]   [150]
      [80 1.0 1]   [200]
      [70 2.5 1]   [120]
   ```

2. **使用最小二乘法求解**
   w = (X^T X)^(-1) X^T y

   计算过程：
   a) 计算 X^T X:
   ```
   X^T X = [50 60 80 70    ]   [50 2.0 1]
          [2.0 1.5 1.0 2.5]   [60 1.5 1]
          [1   1   1   1  ]   [80 1.0 1]
                              [70 2.5 1]
   ```

   b) 计算 (X^T X)^(-1)
   c) 计算 X^T y
   d) 最后得到权重向量 w

3. **Python代码实现**
```python
import numpy as np

# 准备数据
X = np.array([
    [50, 2.0, 1],
    [60, 1.5, 1],
    [80, 1.0, 1],
    [70, 2.5, 1]
])
y = np.array([100, 150, 200, 120])

# 计算权重
w = np.linalg.inv(X.T @ X) @ X.T @ y

# 输出结果
print(f"w1 (面积权重) = {w[0]:.2f}")
print(f"w2 (距离权重) = {w[1]:.2f}")
print(f"b (偏置项) = {w[2]:.2f}")
```

4. **结果解释**
假设得到：
- w₁ = 2.5（每增加1平方米，房价增加2.5万）
- w₂ = -20（每远离地铁站1公里，房价减少20万）
- b = 30（基础价格30万）

则预测公式为：
房价 = 2.5×面积 - 20×地铁距离 + 30

### 2.4 使用模型预测
例如，预测一个65平米，距地铁1.8公里的房子价格：
```python
面积 = 65
距离 = 1.8
预测价格 = 2.5 × 65 - 20 × 1.8 + 30
        = 162.5 - 36 + 30
        = 156.5万
```

## 3. 要点说明
1. 最小二乘法本质是最小化预测值与实际值的平方差
2. 矩阵求解方法比迭代方法（如梯度下降）更直接
3. 需要注意特征量纲统一，通常需要标准化处理
4. 当样本数量少于特征数量时，矩阵可能不可逆，需要使用其他方法

## 4. 实际应用注意事项
1. 数据预处理很重要，需要处理：
   - 缺失值
   - 异常值
   - 特征标准化
2. 多重共线性问题：特征间高度相关会影响模型稳定性
3. 过拟合问题：可以考虑使用正则化（L1/L2）
4. 模型评估：使用R²、MSE等指标评估模型效果
